{"ast":null,"code":"import{create}from'zustand';import{persist}from'zustand/middleware';import{adminApi,apiUtils}from'../api';export const useAuthStore=create()(persist((set,get)=>({user:null,token:null,loading:false,error:null,login:async credentials=>{set({loading:true,error:null});try{const tokenResponse=await adminApi.login(credentials);// Store token\nlocalStorage.setItem('admin_token',tokenResponse.access_token);set({token:tokenResponse.access_token,user:{username:credentials.username,// Mock user data - in real app, fetch user details\nid:1,email:'',is_active:true,is_superuser:true,created_at:new Date().toISOString()},loading:false});return true;}catch(error){set({error:apiUtils.handleApiError(error),loading:false});return false;}},logout:()=>{localStorage.removeItem('admin_token');set({user:null,token:null,error:null});},checkAuth:()=>{const token=localStorage.getItem('admin_token');if(token){set({token,// In real app, validate token and fetch user data\nuser:{id:1,username:'admin',email:'admin@guestbook.local',is_active:true,is_superuser:true,created_at:new Date().toISOString()}});}},clearError:()=>set({error:null})}),{name:'auth-storage',partialize:state=>({token:state.token,user:state.user})}));","map":{"version":3,"names":["create","persist","adminApi","apiUtils","useAuthStore","set","get","user","token","loading","error","login","credentials","tokenResponse","localStorage","setItem","access_token","username","id","email","is_active","is_superuser","created_at","Date","toISOString","handleApiError","logout","removeItem","checkAuth","getItem","clearError","name","partialize","state"],"sources":["/Users/renesuss/Development/Tools/src/guestbook-project/frontend/src/store/authStore.ts"],"sourcesContent":["import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\nimport { AuthStore, LoginForm, AdminUser } from '../types';\nimport { adminApi, apiUtils } from '../api';\n\nexport const useAuthStore = create<AuthStore>()(\n  persist(\n    (set, get) => ({\n      user: null,\n      token: null,\n      loading: false,\n      error: null,\n\n      login: async (credentials: LoginForm) => {\n        set({ loading: true, error: null });\n        try {\n          const tokenResponse = await adminApi.login(credentials);\n          \n          // Store token\n          localStorage.setItem('admin_token', tokenResponse.access_token);\n          \n          set({\n            token: tokenResponse.access_token,\n            user: { \n              username: credentials.username,\n              // Mock user data - in real app, fetch user details\n              id: 1,\n              email: '',\n              is_active: true,\n              is_superuser: true,\n              created_at: new Date().toISOString()\n            } as AdminUser,\n            loading: false,\n          });\n\n          return true;\n        } catch (error) {\n          set({\n            error: apiUtils.handleApiError(error),\n            loading: false,\n          });\n          return false;\n        }\n      },\n\n      logout: () => {\n        localStorage.removeItem('admin_token');\n        set({\n          user: null,\n          token: null,\n          error: null,\n        });\n      },\n\n      checkAuth: () => {\n        const token = localStorage.getItem('admin_token');\n        if (token) {\n          set({ \n            token,\n            // In real app, validate token and fetch user data\n            user: {\n              id: 1,\n              username: 'admin',\n              email: 'admin@guestbook.local',\n              is_active: true,\n              is_superuser: true,\n              created_at: new Date().toISOString()\n            }\n          });\n        }\n      },\n\n      clearError: () => set({ error: null }),\n    }),\n    {\n      name: 'auth-storage',\n      partialize: (state) => ({ \n        token: state.token,\n        user: state.user \n      }),\n    }\n  )\n);\n"],"mappings":"AAAA,OAASA,MAAM,KAAQ,SAAS,CAChC,OAASC,OAAO,KAAQ,oBAAoB,CAE5C,OAASC,QAAQ,CAAEC,QAAQ,KAAQ,QAAQ,CAE3C,MAAO,MAAM,CAAAC,YAAY,CAAGJ,MAAM,CAAY,CAAC,CAC7CC,OAAO,CACL,CAACI,GAAG,CAAEC,GAAG,IAAM,CACbC,IAAI,CAAE,IAAI,CACVC,KAAK,CAAE,IAAI,CACXC,OAAO,CAAE,KAAK,CACdC,KAAK,CAAE,IAAI,CAEXC,KAAK,CAAE,KAAO,CAAAC,WAAsB,EAAK,CACvCP,GAAG,CAAC,CAAEI,OAAO,CAAE,IAAI,CAAEC,KAAK,CAAE,IAAK,CAAC,CAAC,CACnC,GAAI,CACF,KAAM,CAAAG,aAAa,CAAG,KAAM,CAAAX,QAAQ,CAACS,KAAK,CAACC,WAAW,CAAC,CAEvD;AACAE,YAAY,CAACC,OAAO,CAAC,aAAa,CAAEF,aAAa,CAACG,YAAY,CAAC,CAE/DX,GAAG,CAAC,CACFG,KAAK,CAAEK,aAAa,CAACG,YAAY,CACjCT,IAAI,CAAE,CACJU,QAAQ,CAAEL,WAAW,CAACK,QAAQ,CAC9B;AACAC,EAAE,CAAE,CAAC,CACLC,KAAK,CAAE,EAAE,CACTC,SAAS,CAAE,IAAI,CACfC,YAAY,CAAE,IAAI,CAClBC,UAAU,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CACrC,CAAc,CACdf,OAAO,CAAE,KACX,CAAC,CAAC,CAEF,MAAO,KAAI,CACb,CAAE,MAAOC,KAAK,CAAE,CACdL,GAAG,CAAC,CACFK,KAAK,CAAEP,QAAQ,CAACsB,cAAc,CAACf,KAAK,CAAC,CACrCD,OAAO,CAAE,KACX,CAAC,CAAC,CACF,MAAO,MAAK,CACd,CACF,CAAC,CAEDiB,MAAM,CAAEA,CAAA,GAAM,CACZZ,YAAY,CAACa,UAAU,CAAC,aAAa,CAAC,CACtCtB,GAAG,CAAC,CACFE,IAAI,CAAE,IAAI,CACVC,KAAK,CAAE,IAAI,CACXE,KAAK,CAAE,IACT,CAAC,CAAC,CACJ,CAAC,CAEDkB,SAAS,CAAEA,CAAA,GAAM,CACf,KAAM,CAAApB,KAAK,CAAGM,YAAY,CAACe,OAAO,CAAC,aAAa,CAAC,CACjD,GAAIrB,KAAK,CAAE,CACTH,GAAG,CAAC,CACFG,KAAK,CACL;AACAD,IAAI,CAAE,CACJW,EAAE,CAAE,CAAC,CACLD,QAAQ,CAAE,OAAO,CACjBE,KAAK,CAAE,uBAAuB,CAC9BC,SAAS,CAAE,IAAI,CACfC,YAAY,CAAE,IAAI,CAClBC,UAAU,CAAE,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CACrC,CACF,CAAC,CAAC,CACJ,CACF,CAAC,CAEDM,UAAU,CAAEA,CAAA,GAAMzB,GAAG,CAAC,CAAEK,KAAK,CAAE,IAAK,CAAC,CACvC,CAAC,CAAC,CACF,CACEqB,IAAI,CAAE,cAAc,CACpBC,UAAU,CAAGC,KAAK,GAAM,CACtBzB,KAAK,CAAEyB,KAAK,CAACzB,KAAK,CAClBD,IAAI,CAAE0B,KAAK,CAAC1B,IACd,CAAC,CACH,CACF,CACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}